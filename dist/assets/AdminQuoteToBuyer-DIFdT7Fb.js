import{e as j,b as g,u as S,r as t,j as e}from"./index-COlOKGVa.js";import{I as k}from"./InquiriesService-D6_IMM9T.js";import{T as P}from"./Topbar-C2H_McEf.js";import{d as q}from"./Product2-CFKujFxf.js";import{B as w}from"./Back-DUcgJcu8.js";const I="http://lyncorganikness.ap-south-1.elasticbeanstalk.com/",D={sendQuoteToBuyer:async(c,u,i)=>{try{const s=localStorage.getItem("authToken");if(console.log("Token:",s),!s)throw console.error("No token found, please login"),new Error("Authorization token is missing.");const o={adminInitialPrice:u,comment:i};console.log("Sending quote with data:",o);const n=await j.post(`${I}auth/admin/adminQuoteToBuyer/${c}`,o,{headers:{Authorization:`Bearer ${s}`}});return console.log("Response from API:",n.data),n.data}catch(s){throw console.error("Error sending quote:",s.response||s.message),s}}},$=()=>{const{queryId:c}=g(),u=S(),[i,s]=t.useState(""),[o,n]=t.useState(""),[h,x]=t.useState(!1),[p,m]=t.useState(""),[a,v]=t.useState(null),[b,y]=t.useState(null),N={label:"Seller Negotiated Price",value:b?`${b} ${a.priceUnit}`:"N/A"};t.useEffect(()=>{(async()=>{var r;try{const d=await k.getInquiryById(c);v(d),((r=d.sellerNegotiations)==null?void 0:r.length)>0&&y(d.sellerNegotiations[0].sellerNegotiatePrice)}catch(d){console.error("Error fetching inquiry details:",d),m("Failed to load inquiry details.")}})()},[c]);const f=async()=>{if(!i||!o){m("Please fill in all fields.");return}x(!0),m("");try{const l=await D.sendQuoteToBuyer(c,i,o);m("Quote sent successfully!"),s(""),n("")}catch(l){console.error("Error sending quote:",l),m("Failed to send the quote. Please try again.")}finally{x(!1)}};return a?e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(P,{title:"Quote Details",userName:"Neha Sharma",showSearchBar:!1}),e.jsxs("div",{className:"container-fluid mt-4",children:[e.jsx(w,{}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card p-4 mb-4",children:[e.jsx("div",{className:"product-image-upload text-center mb-3",children:e.jsx("img",{src:q,className:"uploaded-image",style:{width:"100%",height:"300px",objectFit:"cover"},alt:"Product"})}),e.jsxs("div",{className:"card-body",children:[[{label:"Buyer ID",value:a.buyerUId},{label:"Query ID",value:a.qid},{label:"Quantity",value:`${a.quantity} ${a.quantityUnit}`},{label:"Price Range",value:`${a.askMinPrice} - ${a.askMaxPrice} ${a.priceUnit}`},{label:"Target Lead Time",value:a.targetLeadTime}].map((l,r)=>e.jsxs("div",{className:"form-group row mb-3",children:[e.jsxs("label",{className:"col-12 col-form-label",children:[l.label,":"]}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:l.value,readOnly:!0})})]},r)),e.jsx("p",{className:"my-2",children:"Required Certifications:"}),["npop","nop","eu","gsdc","ipm","other"].map((l,r)=>e.jsxs("div",{className:"form-check mb-3",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:a[l]||!1,readOnly:!0}),e.jsx("label",{className:"form-check-label",children:l.toUpperCase()})]},r))]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card p-4 mb-4",children:e.jsxs("div",{className:"card-body",children:[[{label:"Product Name",value:a.productName},{label:"Variety",value:a.varietyName},{label:"Form",value:a.formName},{label:"Packaging Material",value:a.packagingMaterial},{label:"Price Terms",value:a.priceTerms}].map((l,r)=>e.jsxs("div",{className:"form-group row mb-3",children:[e.jsxs("label",{className:"col-12 col-form-label",children:[l.label,":"]}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:l.value,readOnly:!0})})]},r)),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"col-form-label",children:"Country"}),e.jsx("input",{type:"text",className:"form-control",value:a.country||"",readOnly:!0})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"col-form-label",children:"State"}),e.jsx("input",{type:"text",className:"form-control",value:a.state||"",readOnly:!0})]})]}),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"col-form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:a.city||"",readOnly:!0})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{className:"col-form-label",children:"Pin-code"}),e.jsx("input",{type:"text",className:"form-control",value:a.pincode||"",readOnly:!0})]})]}),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsx("label",{className:"col-12 col-form-label",children:"Delivery Date"}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:a.specifyDeliveryDate||"",readOnly:!0})})]}),e.jsx("div",{className:"bg-warning mb-2 w-100 text-center p-3 rounded",children:"Update Quote and Send to Buyer"}),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsxs("label",{className:"col-12 col-form-label",children:[N.label,":"]}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:N.value,readOnly:!0})})]}),e.jsxs("form",{onSubmit:l=>l.preventDefault(),children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"price",className:"form-label",children:"Price"}),e.jsx("input",{type:"number",className:"form-control",id:"price",placeholder:"Enter the proposal price",value:i,onChange:l=>s(l.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"comment",className:"form-label",children:"Comment"}),e.jsx("textarea",{className:"form-control",id:"comment",placeholder:"Enter a comment",value:o,onChange:l=>n(l.target.value)})]}),e.jsx("button",{className:"btn btn-dark",onClick:f,disabled:h,children:h?"Submitting...":"Submit Quote"}),p&&e.jsx("p",{className:"mt-3",children:p})]})]})})})]})]})]}):e.jsxs("div",{className:"container mt-4",children:[e.jsx("h3",{className:"text-danger text-center",children:"Inquiry Details Not Available"}),e.jsx("button",{className:"btn btn-secondary mt-4",onClick:()=>u(-1),children:"Go Back"})]})};export{$ as default};
