import{e as N,c as b,r as i,j as e}from"./index-COlOKGVa.js";import{I as j}from"./InquiriesService-D6_IMM9T.js";import{T as v}from"./Topbar-C2H_McEf.js";import{d as f}from"./Product2-CFKujFxf.js";import{B as P}from"./Back-DUcgJcu8.js";const x="http://lyncorganikness.ap-south-1.elasticbeanstalk.com/auth/admin",S=async(o,l)=>{try{const t=localStorage.getItem("authToken");if(!t)throw new Error("Auth token missing");return console.log("Sending POST request to:",`${x}/adminSentFinalPriceToBuyer/${o}`),console.log("Payload:",l),await N.post(`${x}/adminSentFinalPriceToBuyer/${o}`,l,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})}catch(t){throw console.error("Error in API call:",t.message),t}},I={sendNegotiationToBuyer:S},B=()=>{const{state:o}=b(),{queryId:l,productId:t}=o||{},[a,p]=i.useState(null),[n,d]=i.useState(0),[m,y]=i.useState(""),[u,c]=i.useState("");if(i.useEffect(()=>{l&&(async()=>{try{const r=await j.getInquiryById(l);p(r)}catch(r){console.error("Error fetching inquiry details:",r),c("Failed to load inquiry details.")}})()},[l]),!l||!t)return e.jsx("div",{children:"Error: Missing queryId or productId!"});const g=async s=>{if(s.preventDefault(),n<=0){c("Negotiated price must be greater than zero");return}const r={amount:n};try{console.log("Submitting negotiation for queryId:",l),(await I.sendNegotiationToBuyer(l,r)).status===200?(y("Negotiation submitted successfully!"),d(0)):c("Failed to submit negotiation. Please try again.")}catch(h){console.error("Error during negotiation submission:",h.message),c("An error occurred during submission. Please try again.")}};return a?e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(v,{title:"Query Details",userName:"Neha Sharma",showSearchBar:!1}),e.jsxs("div",{className:"container mt-5",children:[e.jsx(P,{}),u&&e.jsx("div",{className:"alert alert-danger",children:u}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"product-image-upload text-center mb-3",children:e.jsx("img",{src:f,className:"uploaded-image",style:{width:"100%",height:"300px",objectFit:"cover"},alt:"Product"})}),[{label:"Buyer ID",value:a.buyerUId},{label:"Query ID",value:a.qid},{label:"Quantity",value:`${a.quantity} ${a.quantityUnit}`},{label:"Price Range",value:`${a.askMinPrice} - ${a.askMaxPrice} ${a.priceUnit}`}].map((s,r)=>e.jsxs("div",{className:"form-group row mb-2",children:[e.jsxs("label",{className:"col-12 col-form-label",children:[s.label,":"]}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:s.value,readOnly:!0})})]},r)),e.jsx("p",{className:"my-2",children:"Required Certifications:"}),["npop","nop","eu","gsdc","ipm","other"].map((s,r)=>e.jsxs("div",{className:"form-check mb-3",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:a[s]||!1,readOnly:!0}),e.jsx("label",{className:"form-check-label",children:s.toUpperCase()})]},r))]})}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("h5",{className:"card-title",children:"Product Details"}),[{label:"Product Name",value:a.productName},{label:"Variety",value:a.varietyName},{label:"Packaging Material",value:a.packagingMaterial},{label:"Price Terms",value:a.priceTerms},{label:"Target Lead Time",value:a.targetLeadTime},{label:"Delivery Address",value:a.deliveryAddress}].map((s,r)=>e.jsxs("div",{className:"form-group row mb-2",children:[e.jsxs("label",{className:"col-12 col-form-label",children:[s.label,":"]}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:s.value,readOnly:!0})})]},r)),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"col-form-label",children:e.jsx("strong",{children:"Country"})}),e.jsx("input",{type:"text",className:"form-control",value:a.country||"",readOnly:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"col-form-label",children:e.jsx("strong",{children:"State"})}),e.jsx("input",{type:"text",className:"form-control",value:a.state||"",readOnly:!0})]})]}),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"col-form-label",children:e.jsx("strong",{children:"City"})}),e.jsx("input",{type:"text",className:"form-control",value:a.city||"",readOnly:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"col-form-label",children:e.jsx("strong",{children:"Pin-code"})}),e.jsx("input",{type:"text",className:"form-control",value:a.pincode||"",readOnly:!0})]})]}),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsx("label",{className:"col-12 col-form-label",children:"Delivery Date"}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:a.specifyDeliveryDate||"",readOnly:!0})})]}),e.jsx("div",{className:"bg-warning mb-2 w-100 text-center p-3 rounded",children:"Update Final Price and Send to Buyer"}),e.jsxs("div",{className:"form-group row mb-3",children:[e.jsx("label",{className:"col-12 col-form-label",children:"Final Price to Buyer"}),e.jsx("div",{className:"col-12",children:e.jsx("input",{type:"text",className:"form-control",value:a.buyerNegotiatePrice||"",readOnly:!0})})]}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"negotiationAmount",className:"form-label",children:"Enter your Negotiated Price"}),e.jsx("input",{type:"number",id:"negotiationAmount",className:"form-control",value:n,onChange:s=>d(s.target.value),required:!0})]}),e.jsx("button",{type:"submit",className:"btn btn-dark",children:"Submit Negotiation"})]})]}),m&&e.jsx("div",{className:"alert alert-success",children:m})]})]})]})]}):e.jsx("div",{className:"container mt-4",children:"Loading inquiry details..."})};export{B as default};
