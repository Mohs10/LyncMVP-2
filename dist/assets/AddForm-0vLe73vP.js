import{e as v,r as l,j as r}from"./index-COlOKGVa.js";const A="http://lyncorganikness.ap-south-1.elasticbeanstalk.com/api/varieties/add",V="http://lyncorganikness.ap-south-1.elasticbeanstalk.com/api/varieties/all",R=async o=>{const s=localStorage.getItem("authToken");if(!s)throw new Error("No token found, please login");try{const a=await v.post(A,{varietyName:o},{headers:{Authorization:`Bearer ${s}`}});console.log("Variety added successfully:",a.data);const c=(await k()).find(h=>h.varietyName===o);if(c)return console.log("Variety found:",c),c;throw new Error("Variety not found after adding.")}catch(a){j(a,"Error adding variety")}},k=async()=>{const o=localStorage.getItem("authToken");if(!o)throw new Error("No token found, please login");try{const s=await v.get(V,{headers:{Authorization:`Bearer ${o}`}});return console.log("Varieties fetched successfully:",s.data),s.data}catch(s){j(s,"Error fetching varieties")}},j=(o,s)=>{throw o.response?(console.error(`${s}:`,o.response.data),new Error(`Error: ${o.response.status} - ${o.response.data}`)):o.request?(console.error("No response received:",o.request),new Error("Network error, please check your connection.")):new Error(`Error: ${o.message}`)},I=({addedVarieties:o,setAddedVarieties:s})=>{const[a,m]=l.useState(""),[c,h]=l.useState(""),[i,u]=l.useState(!1),[g,d]=l.useState(""),[y,w]=l.useState([]),p=async()=>{try{const e=await k();w(e),console.log("Fetched varieties:",e)}catch(e){d(e.message),console.error("Error fetching varieties:",e)}};l.useEffect(()=>{p()},[]);const N=async()=>{u(!0),d("");try{if(a.trim()!==""){const e=await R(a);e&&e.varietyName?(s(t=>[...t,e]),console.log("Added variety to badges:",e.varietyName)):console.warn("Variety added but response does not contain varietyName."),m(""),await p()}else d("Variety name cannot be empty.")}catch(e){d("Failed to add variety."),console.error("Error adding variety:",e)}finally{u(!1)}},x=e=>{const t=e.target.value,f=y.find(n=>n.varietyName===t);h(t),t&&!o.some(n=>n.varietyName===t)&&(s(n=>[...n,f]),console.log("Added existing variety to badges:",t))},b=e=>{const t=o[e];s(f=>f.filter((n,E)=>E!==e)),console.log("Removed variety:",t)};return r.jsxs("div",{className:"form-group row mb-3",children:[r.jsx("label",{className:"col-12 col-form-label",children:"Add Product Variety"}),r.jsx("div",{className:"col-8",children:r.jsxs("select",{className:"form-control",value:c,onChange:x,disabled:i,children:[r.jsx("option",{value:"",children:"Select a variety"}),y.map((e,t)=>r.jsx("option",{value:e.varietyName,children:e.varietyName},t))]})}),r.jsx("div",{className:"col-8 mt-2",children:r.jsx("input",{type:"text",className:"form-control",placeholder:"Enter variety name",value:a,onChange:e=>m(e.target.value),disabled:i})}),r.jsx("div",{className:"col-4 mt-2",children:r.jsx("button",{type:"button",className:"btn btn-dark",style:{height:"42px",width:"110px"},onClick:N,disabled:i,children:i?"Adding...":"Add"})}),g&&r.jsx("div",{className:"col-12 mt-2 text-danger",children:r.jsx("small",{children:g})}),r.jsx("div",{className:"mt-2",children:o.map((e,t)=>r.jsxs("span",{className:"badge btn-outline-warning text-dark me-2",style:{cursor:"pointer",fontWeight:400,border:"1px solid #FFD500",backgroundColor:"white"},onClick:()=>b(t),children:[e.varietyName," ×"]},t))})]})},$="http://lyncorganikness.ap-south-1.elasticbeanstalk.com/api/forms/add",C="http://lyncorganikness.ap-south-1.elasticbeanstalk.com/api/forms/all",T=async o=>{const s=localStorage.getItem("authToken");if(console.log(o),!s)throw new Error("No token found, please login");try{const a=await v.post($,{formName:o},{headers:{Authorization:`Bearer ${s}`}});console.log("Form added successfully:",a.data);const c=(await F()).find(h=>h.formName===o);if(c)return console.log("Form found:",c),c;throw new Error("Form not found after adding.")}catch(a){S(a,"Error adding form")}},F=async()=>{const o=localStorage.getItem("authToken");if(!o)throw new Error("No token found, please login");try{const s=await v.get(C,{headers:{Authorization:`Bearer ${o}`}});return console.log("Forms fetched successfully:",s.data),s.data}catch(s){S(s,"Error fetching forms")}},S=(o,s)=>{throw o.response?(console.error(`${s}:`,o.response.data),new Error(`Error: ${o.response.status} - ${o.response.data}`)):o.request?(console.error("No response received:",o.request),new Error("Network error, please check your connection.")):new Error(`Error: ${o.message}`)},L=({addedForms:o,setAddedForms:s})=>{const[a,m]=l.useState(""),[c,h]=l.useState(""),[i,u]=l.useState(!1),[g,d]=l.useState(""),[y,w]=l.useState([]),p=async()=>{try{const e=await F();w(e),console.log("Fetched forms:",e)}catch(e){d(e.message),console.error("Error fetching forms:",e)}};l.useEffect(()=>{p()},[]);const N=async()=>{u(!0),d("");try{if(a.trim()!==""){const e=await T(a);e&&e.formName?(s(t=>[...t,e]),console.log("Added form to badges:",e.formName)):console.warn("Form added but response does not contain formName."),m(""),await p()}else d("Form name cannot be empty.")}catch(e){d("Failed to add form."),console.error("Error adding form:",e)}finally{u(!1)}},x=e=>{const t=e.target.value,f=y.find(n=>n.formName===t);h(t),t&&!o.some(n=>n.formName===t)&&(s(n=>[...n,f]),console.log("Added existing form to badges:",t))},b=e=>{const t=o[e];s(f=>f.filter((n,E)=>E!==e)),console.log("Removed form:",t)};return r.jsxs("div",{className:"form-group row mb-3",children:[r.jsx("label",{className:"col-12 col-form-label",children:"Add Form"}),r.jsx("div",{className:"col-8",children:r.jsxs("select",{className:"form-control",value:c,onChange:x,disabled:i,children:[r.jsx("option",{value:"",children:"Select a form"}),y.map((e,t)=>r.jsx("option",{value:e.formName,children:e.formName},t))]})}),r.jsx("div",{className:"col-8 mt-2",children:r.jsx("input",{type:"text",className:"form-control",placeholder:"Enter form name",value:a,onChange:e=>m(e.target.value),disabled:i})}),r.jsx("div",{className:"col-4 mt-2",children:r.jsx("button",{type:"button",className:"btn btn-dark",style:{height:"42px",width:"110px"},onClick:N,disabled:i,children:i?"Adding...":"Add"})}),g&&r.jsx("div",{className:"col-12 mt-2 text-danger",children:r.jsx("small",{children:g})}),r.jsx("div",{className:"mt-2",children:o.map((e,t)=>r.jsxs("span",{className:"badge btn-outline-warning text-dark me-2",style:{cursor:"pointer",fontWeight:400,border:"1px solid #FFD500",backgroundColor:"white"},onClick:()=>b(t),children:[e.formName," ×"]},t))})]})};export{I as A,L as a};
